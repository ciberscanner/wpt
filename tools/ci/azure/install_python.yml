steps:
- powershell: |
    Start-BitsTransfer -Source https://www.python.org/ftp/python/3.8.5/python-3.8.5-amd64.exe  -Destination python_installer.exe
    $hash = (Get-FileHash python_installer.exe).Hash.ToLower()
    $expectedHash = "cd427c7b17337d7c13761ca20877d2d8be661bd30415ddc17072a31a65a91b64"
    if ($hash.Equals($expectedHash)) {
      Write-Host "python_installer.exe hash verified"
    } else {
      Throw "python_installer.exe hash mismatch, got $hash, expected $expectedHash"
    }
    & .\python_installer.exe /passive TargetDir=C:\Python38
    Write-Host "##vso[task.prependpath]C:\Python38"
    Write-Host "##vso[task.prependpath]C:\Python38\Scripts"
  displayName: 'Install Python (Windows)'
  condition: and(succeeded(), eq(variables['Agent.OS'], 'Windows_NT'))
